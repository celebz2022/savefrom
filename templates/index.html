<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Instagram Video Downloader</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <h2>Instagram Video Downloader</h2>
        <input type="text" id="url" placeholder="Paste Instagram link here"/>
        <button onclick="downloadVideo()">Download</button>
        <footer>Powered by your affiliate link</footer>
    </div>

    <script>
    function downloadVideo() {
        let url = document.getElementById("url").value;

        fetch("/download", {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify({url})
        })
        .then(res => res.json())
        .then(data => {
            if(data.error){
                alert(data.error);
                return;
            }

            // Open affiliate popup
            window.open("https://www.amazon.ae/dp/B07DX89ZHN?tag=healthhackzon-21", "_blank");

            // Trigger actual video download
            const a = document.createElement("a");
            a.href = data.download_url;
            a.download = data.title + ".mp4";
            document.body.appendChild(a);
            a.click();
            a.remove();
        })
        .catch(err => alert("Error: " + err));
    }
    </script>
</body>
</html>

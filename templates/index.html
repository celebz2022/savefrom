<!DOCTYPE html>
<html>
<head>
    <title>Instagram Video Downloader</title>
</head>
<body>
    <h2>Instagram Video Downloader</h2>
    <input type="text" id="url" placeholder="Paste Instagram link here" size="50"/>
    <button onclick="downloadVideo()">Download</button>

    <script>
        function downloadVideo() {
            let url = document.getElementById("url").value;
            if(!url) {
                alert("Please enter a link!");
                return;
            }

            fetch("/download", {
                method: "POST",
                headers: {"Content-Type": "application/json"},
                body: JSON.stringify({url})
            })
            .then(res => res.json())
            .then(data => {
                if(data.error){
                    alert("Error: " + data.error);
                    return;
                }

                // Open Amazon affiliate link in new tab
                window.open("https://www.amazon.ae/dp/B07DX89ZHN?tag=healthhackzon-21", "_blank");

                // Trigger video download
                const a = document.createElement("a");
                a.href = data.download_url;
                a.download = "InstagramVideo.mp4";
                document.body.appendChild(a);
                a.click();
                a.remove();
            })
            .catch(err => alert("Error: " + err));
        }
    </script>
</body>
</html>
